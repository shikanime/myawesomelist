syntax = "proto3";

package myawesomelist.v1;

option go_package = "myawesomelist.shikanime.studio/pkgs/proto/myawesomelist/v1;myawesomelistv1";

// Project represents a single project from an awesome list
message ProjectsStats {
  optional int64 stargazers_count = 1;
  optional int64 open_issue_count = 2;
}

message Project {
  string name = 1;
  string description = 2;
  string url = 3;
  ProjectsStats stats = 4;
}

// Category groups projects under a section
message Category {
  string name = 1;
  repeated Project projects = 2;
}

// Collection represents an awesome repository parsed into categories
message Collection {
  string language = 1;
  repeated Category categories = 2;
}

// Identify a source awesome repository (owner/repo)
message Repository {
  string owner = 1;
  string repo = 2;
}

// Requests/Responses

message ListCollectionsRequest {}

message ListCollectionsResponse {
  repeated Collection collections = 1;
}

message GetCollectionRequest {
  Repository repo = 1;
}

message GetCollectionResponse {
  Collection collection = 1;
}

message ListCategoriesRequest {
  Repository repo = 1;
}

message ListCategoriesResponse {
  repeated Category categories = 1;
}

message ListProjectsRequest {
  Repository repo = 1;
  string category_name = 2;
}

message ListProjectsResponse {
  repeated Project projects = 1;
}

message SearchProjectsRequest {
  string query = 1;
  int32 limit = 2;
  repeated Repository repos = 3;
}

message SearchProjectsResponse {
  repeated Project projects = 1;
}

message LivenessRequest {}
message LivenessResponse {}

message ReadinessRequest {}
message ReadinessResponse {}

message GetProjectStatsRequest {
  Repository repo = 1;
}

message GetProjectStatsResponse {
  ProjectsStats stats = 1;
}

// Service

service AwesomeService {
  rpc Liveness(LivenessRequest) returns (LivenessResponse);
  rpc Readiness(ReadinessRequest) returns (ReadinessResponse);

  rpc ListCollections(ListCollectionsRequest) returns (ListCollectionsResponse);
  rpc GetCollection(GetCollectionRequest) returns (GetCollectionResponse);

  rpc ListCategories(ListCategoriesRequest) returns (ListCategoriesResponse);
  rpc ListProjects(ListProjectsRequest) returns (ListProjectsResponse);

  rpc SearchProjects(SearchProjectsRequest) returns (SearchProjectsResponse);

  rpc GetProjectStats(GetProjectStatsRequest) returns (GetProjectStatsResponse);
}